<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>近况</title>
    <link href="/2026/01/16/%E4%B8%AA%E4%BA%BA%E8%BF%91%E5%86%B5/"/>
    <url>/2026/01/16/%E4%B8%AA%E4%BA%BA%E8%BF%91%E5%86%B5/</url>
    
    <content type="html"><![CDATA[<p>毕业半年，简单记录一下这段时间的经历与感受，也算给自己留个回顾的锚点。</p><h2 id="求职与选择"><a href="#求职与选择" class="headerlink" title="求职与选择"></a>求职与选择</h2><p>研三这一整年基本都在找工作，陆续参加了几次事业单位考试。2025 年 4 月参加人才引进，被引进到湖南某县城的自然资源事务中心。去现场提交材料的那天就有点后悔：总觉得周边县市的发展并没有真正“带上”它。</p><p>犹豫了很久，最终还是放弃了。后面导师推荐我去做科研助理，我答应之后就没有再继续找工作。</p><h2 id="答辩后"><a href="#答辩后" class="headerlink" title="答辩后"></a>答辩后</h2><p>答辩结束后，看着同学们陆续离校，但我这边一直没有明确的入职时间。我就留在学校，帮老师做些杂活，一直待到八月份。</p><p>到了八月仍然没有等到具体通知，我决定先去找工作：在各大招聘网站投简历，投了几家地信公司的岗位。最后入职了一家地信公司，工作内容主要是<strong>遥感模型训练</strong>相关（数据处理、模型搭建与调参等）。</p><h2 id="驻场项目"><a href="#驻场项目" class="headerlink" title="驻场项目"></a>驻场项目</h2><p>9 月去公司总部报道，一周时间熟悉文档后就南下广州。实际上是到客户单位驻场办公。</p><p>到现场后才发现项目推进并不顺利，主要卡在两点：</p><ul><li><strong>数据不全</strong>：关键数据缺失，导致训练与验证链条不完整；</li><li><strong>流程不规范</strong>：客户现有的数据处理流程不统一，很多环节需要重新对齐口径。</li></ul><p>前期花了不少时间沟通需求、梳理数据现状。有点难绷的是：项目已经临近交付节点，但模型精度只能说“勉强可用”，距离客户要求还有差距。只能继续迭代优化、调整参数，希望在最后关头把指标再抬一抬。</p><p>几轮调整和测试后，效果确实有所提升，但仍没达到客户预期。最后只能如实沟通现状，并给出后续改进方案。客户表示理解，但也希望我们尽快交付一个可用版本。</p><h2 id="两头跑"><a href="#两头跑" class="headerlink" title="两头跑"></a>两头跑</h2><p>10 月底项目终于验收告一段落，但同事离职了。我被安排接手他的项目，去新的客户单位驻场办公。没办法，只能两头跑：</p><ul><li>这边继续优化之前的模型；</li><li>那边进入售后保障阶段，工作量相对小一些，但仍需要盯现场。</li></ul><p>其实两边的现场实施并不算难，培训一段时间基本能独立操作。最关键的问题是<strong>缺人</strong>：人手不够，工作量就直接翻倍。客户也不会给太多“学习时间”，只能边学边做、边做边补。</p><h2 id="转前场"><a href="#转前场" class="headerlink" title="转前场"></a>转前场</h2><p>到了 11 月，公司调整发展方向，要求技术人员全部转前场做售前。说白了更像销售，而从我的能力结构和性格来说，这并不适合。</p><p>挣扎了一段时间后，我还是决定离职。做不擅长的事情，短期也许能硬扛，但长期对个人发展没有好处。</p><p>这里也顺便吐槽两句：地信行业的很多细分市场其实早就趋于饱和，现在才入场、再去转云服务和售前，只能说有点晚。更现实的是，很多技术同事并不适合销售型工作，转型成功率并不高。再加上竞争激烈、需求碎片化，如果公司拿不出足够有竞争力的产品和交付能力，很难站稳。</p><h2 id="科研助理"><a href="#科研助理" class="headerlink" title="科研助理"></a>科研助理</h2><p>离职后，我请老师帮忙重新联系之前的科研助理岗位。沟通后又回去做科研助理，工作内容和读研时差不多：协助处理科研项目相关事务。</p><p>回到熟悉环境，节奏确实轻松不少，但工资一般，也有点“温水煮青蛙”的感觉。好处是至少不用再两头跑了。</p><h2 id="一些感受与反思"><a href="#一些感受与反思" class="headerlink" title="一些感受与反思"></a>一些感受与反思</h2><p>虽然在私企待的时间不长，但感受很深：</p><ul><li>工作强度和压力普遍更大，需要更强的抗压与适应；</li><li>节奏更快，要求快速响应、快速交付；</li><li>对刚毕业的人来说，确实需要时间磨合。</li></ul><p>另外也越来越感到：地信这碗饭变得更难吃了——项目少、竞争大、工资低，发展空间有限；回款慢、工资延发也并不稀奇，工作和生活更难平衡。</p><p>目前这段状态也算过渡。职业规划真的很重要，东搞一下西搞一下，容易两头落空。到现在我仍不确定以后要做什么——先走一步看一步吧。</p>]]></content>
    
    
    <categories>
      
      <category>近况</category>
      
    </categories>
    
    
    <tags>
      
      <tag>就业</tag>
      
      <tag>工作</tag>
      
      <tag>生活</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>全球矿物结合态土壤有机碳储量与固碳潜力研究</title>
    <link href="/2026/01/15/%E5%85%A8%E7%90%83%E7%9F%BF%E7%89%A9%E7%BB%93%E5%90%88%E6%80%81%E5%9C%9F%E5%A3%A4%E6%9C%89%E6%9C%BA%E7%A2%B3%E5%82%A8%E9%87%8F%E4%B8%8E%E5%9B%BA%E7%A2%B3%E6%BD%9C%E5%8A%9B%E7%A0%94%E7%A9%B6/"/>
    <url>/2026/01/15/%E5%85%A8%E7%90%83%E7%9F%BF%E7%89%A9%E7%BB%93%E5%90%88%E6%80%81%E5%9C%9F%E5%A3%A4%E6%9C%89%E6%9C%BA%E7%A2%B3%E5%82%A8%E9%87%8F%E4%B8%8E%E5%9B%BA%E7%A2%B3%E6%BD%9C%E5%8A%9B%E7%A0%94%E7%A9%B6/</url>
    
    <content type="html"><![CDATA[<h2 id="引言：土壤碳——气候变化的隐形调节器"><a href="#引言：土壤碳——气候变化的隐形调节器" class="headerlink" title="引言：土壤碳——气候变化的隐形调节器"></a>引言：土壤碳——气候变化的隐形调节器</h2><p>当我们讨论应对气候变化的策略时，往往聚焦于减少化石燃料排放、发展可再生能源或保护森林等地上生态系统。然而，我们脚下的土壤，作为陆地生态系统中最大的有机碳库，正默默扮演着气候变化调节器的关键角色。土壤有机碳总量超过大气和植被碳的总和，其微小变化都可能对全球碳循环产生深远影响。</p><p>在土壤有机碳的复杂世界中，矿物结合态有机碳（Mineral-Associated Organic Carbon, MOC）是其中最稳定的组分。它通过与土壤矿物的化学和物理结合，形成了一个可以保存数百年甚至数千年的碳储存库。这种稳定的碳储存形式，对于理解土壤碳的长期固存机制和评估土壤固碳潜力至关重要。</p><p>今天，我将为大家解读一篇发表在《Nature Communications》上的重要研究——《Global stocks and capacity of mineral-associated soil organic carbon》。这项研究首次提供了全球尺度上矿物结合态有机碳储量及其储存容量的定量评估，为我们理解土壤碳固存潜力和制定有效的土壤碳管理策略提供了科学依据。</p><h2 id="研究概述"><a href="#研究概述" class="headerlink" title="研究概述"></a>研究概述</h2><h3 id="文章基本信息"><a href="#文章基本信息" class="headerlink" title="文章基本信息"></a>文章基本信息</h3><p><strong>原文标题</strong>：Global stocks and capacity of mineral-associated soil organic carbon<br><strong>期刊名称</strong>：Nature Communications<br><strong>期刊级别</strong>：JCR分区 Q1；中科院分区 1区<br><strong>影响因子</strong>：15.7<br><strong>原文链接</strong>：<a href="https://www.nature.com/articles/s41467-022-31540-9">https://www.nature.com/articles/s41467-022-31540-9</a><br><strong>文章DOI</strong>：<a href="https://doi.org/10.1038/s41467-022-31540-9">https://doi.org/10.1038/s41467-022-31540-9</a></p><h3 id="核心观点"><a href="#核心观点" class="headerlink" title="核心观点"></a>核心观点</h3><p>这项研究基于全球1144个土壤剖面数据，揭示了矿物结合态有机碳的全球分布格局和固碳潜力：</p><ul><li>全球非多年冻土矿质土壤1米深度范围内，矿物结合态有机碳储量约为899 Pg C</li><li>目前仅利用了矿物结合态碳理论储存容量的42%（表层土壤）和21%（深层土壤）</li><li>农业管理区域和深层土壤表现出最显著的矿物结合态碳”不饱和”状态</li><li>距离矿物学储存容量越远的土壤，其碳积累效率越高</li></ul><h2 id="研究背景：为什么关注矿物结合态有机碳？"><a href="#研究背景：为什么关注矿物结合态有机碳？" class="headerlink" title="研究背景：为什么关注矿物结合态有机碳？"></a>研究背景：为什么关注矿物结合态有机碳？</h2><h3 id="土壤有机碳的重要性"><a href="#土壤有机碳的重要性" class="headerlink" title="土壤有机碳的重要性"></a>土壤有机碳的重要性</h3><p>土壤有机碳（SOC）是陆地生态系统的核心组成部分，支持着以下关键生态功能：</p><ul><li>营养循环：为植物生长提供必需的养分</li><li>水分保持：增强土壤的持水能力，提高抗旱性</li><li>抗侵蚀能力：改善土壤结构，减少水土流失</li><li>碳储存：作为全球最大的陆地碳库，调节大气CO₂浓度</li></ul><h3 id="矿物结合态有机碳的特殊性"><a href="#矿物结合态有机碳的特殊性" class="headerlink" title="矿物结合态有机碳的特殊性"></a>矿物结合态有机碳的特殊性</h3><p>矿物关联有机碳（MOC）通过与矿物的化学和物理交互，构成了SOC的一半以上。与颗粒有机碳（POC）相比，MOC具有以下特点：</p><ul><li><strong>稳定性高</strong>：周转时间长达100-10000年，比POC长约1000倍</li><li><strong>受保护程度高</strong>：与矿物的结合限制了微生物的分解作用</li><li><strong>长期固存潜力大</strong>：是实现长期土壤碳固存的关键组分</li></ul><h3 id="研究的紧迫性"><a href="#研究的紧迫性" class="headerlink" title="研究的紧迫性"></a>研究的紧迫性</h3><p>尽管MOC对长期碳固存至关重要，但全球范围内MOC的现有库存与矿物学最大容量尚未被量化，这限制了我们对以下问题的判断：</p><ul><li>全球土壤的固碳潜力有多大？</li><li>哪些区域的土壤具有最高的固碳效率？</li><li>如何制定优先的土壤碳管理策略？</li></ul><h2 id="研究目标与方法"><a href="#研究目标与方法" class="headerlink" title="研究目标与方法"></a>研究目标与方法</h2><h3 id="研究目标"><a href="#研究目标" class="headerlink" title="研究目标"></a>研究目标</h3><p>本研究旨在：</p><ol><li>量化全球矿物结合态有机碳（MOC）的储量</li><li>评估全球矿物结合态有机碳的最大储存容量（MOCmax）</li><li>分析不同生态系统和土壤深度下的矿物结合态碳饱和度（%C saturation）</li><li>探讨矿物结合态碳饱和度与碳积累效率的关系</li></ol><h3 id="研究方法"><a href="#研究方法" class="headerlink" title="研究方法"></a>研究方法</h3><h4 id="1-数据收集与分类"><a href="#1-数据收集与分类" class="headerlink" title="1. 数据收集与分类"></a>1. 数据收集与分类</h4><ul><li><strong>土壤剖面数据</strong>：收集了全球1144个分布广泛的土壤剖面数据，覆盖多种生物群落、气候和地表覆盖类型</li><li><strong>管理干预数据</strong>：分析了103项涉及不同管理措施的土壤碳积累观测结果</li><li><strong>矿物类型分类</strong>：根据土壤主导矿物类型将样点分为：<ul><li>高活性矿物（HM）：如伊利石、蒙脱石等</li><li>低活性矿物（LM）：如高岭石、三水铝石等</li></ul></li></ul><h4 id="2-矿物结合态碳最大容量（MOCmax）估算"><a href="#2-矿物结合态碳最大容量（MOCmax）估算" class="headerlink" title="2. 矿物结合态碳最大容量（MOCmax）估算"></a>2. 矿物结合态碳最大容量（MOCmax）估算</h4><ul><li>使用观测数据的95%上分位数（95th quantile）推估不同矿物类型的MOCmax</li><li>高活性矿物（HM）的MOCmax约为86 ± 9 mg C g⁻¹</li><li>低活性矿物（LM）的MOCmax约为48 ± 6 mg C g⁻¹</li></ul><h4 id="3-全球尺度预测"><a href="#3-全球尺度预测" class="headerlink" title="3. 全球尺度预测"></a>3. 全球尺度预测</h4><ul><li>应用随机森林机器学习模型（R²&#x3D;0.60）预测MOC分布</li><li>生成0.5°分辨率的全球MOC和MOCmax地图</li><li>排除苔原、泥炭地和沙漠等特殊生态系统</li></ul><h4 id="4-矿物结合态碳饱和度计算"><a href="#4-矿物结合态碳饱和度计算" class="headerlink" title="4. 矿物结合态碳饱和度计算"></a>4. 矿物结合态碳饱和度计算</h4><ul><li>计算公式：%C saturation &#x3D; 观测MOC &#x2F; MOCmax</li><li>分析不同生态系统、土壤深度和管理方式下的饱和度差异</li></ul><h2 id="研究结果：全球矿物结合态有机碳的分布与潜力"><a href="#研究结果：全球矿物结合态有机碳的分布与潜力" class="headerlink" title="研究结果：全球矿物结合态有机碳的分布与潜力"></a>研究结果：全球矿物结合态有机碳的分布与潜力</h2><h3 id="1-全球矿物结合态有机碳储量"><a href="#1-全球矿物结合态有机碳储量" class="headerlink" title="1. 全球矿物结合态有机碳储量"></a>1. 全球矿物结合态有机碳储量</h3><p>研究结果显示，在非永久冻土的矿质土壤1米深度范围内：</p><ul><li>矿物结合态有机碳总储量约为899 Pg C（5-95%置信区间：668-1074 Pg C）</li><li>表层土壤（0-30 cm）：约448 Pg C</li><li>深层土壤（30-100 cm）：约451 Pg C</li></ul><p>这一发现表明，深层土壤的矿物结合态碳储量与表层土壤相当，强调了深层土壤在全球碳循环中的重要性。</p><h3 id="2-全球矿物结合态碳容量与饱和度"><a href="#2-全球矿物结合态碳容量与饱和度" class="headerlink" title="2. 全球矿物结合态碳容量与饱和度"></a>2. 全球矿物结合态碳容量与饱和度</h3><ul><li><strong>全球MOCmax总量</strong>：约4596 Pg C ± 453 Pg C（1米深度，排除特殊生态系统）</li><li><strong>平均饱和度</strong>：仅约40%（±95% CI）</li><li><strong>表层土壤</strong>：饱和度约42%</li><li><strong>深层土壤</strong>：饱和度仅约21%</li></ul><p>这意味着全球土壤仍具有巨大的矿物结合态碳固存潜力，尤其是深层土壤。</p><h3 id="3-不同生态系统和管理方式的影响"><a href="#3-不同生态系统和管理方式的影响" class="headerlink" title="3. 不同生态系统和管理方式的影响"></a>3. 不同生态系统和管理方式的影响</h3><ul><li><strong>管理生态系统 vs 自然生态系统</strong>：农业管理区域的饱和度（约31%）显著低于自然生态系统（约46%）</li><li><strong>不同生态系统类型</strong>：农田 &lt; 草原 &lt; 森林</li><li><strong>土壤深度效应</strong>：深层土壤的饱和度普遍低于表层土壤</li></ul><p>这些结果表明，农业管理活动导致了土壤矿物结合态碳的显著损失，同时也意味着农业土壤具有较大的固碳潜力。</p><h3 id="4-碳积累效率与饱和度的关系"><a href="#4-碳积累效率与饱和度的关系" class="headerlink" title="4. 碳积累效率与饱和度的关系"></a>4. 碳积累效率与饱和度的关系</h3><p>研究发现，土壤碳积累效率与矿物结合态碳饱和度呈负相关：</p><ul><li>当土壤碳储量仅达到矿物容量的十分之一时，其碳固存速率平均是一半容量土壤的3倍</li><li>随着饱和度的增加，碳积累效率逐渐降低</li><li>这一关系符合渐近线模型，表明土壤碳积累存在上限</li></ul><p>这一发现对于制定土壤碳管理策略具有重要意义：距离矿物容量越远的土壤，通过管理措施增加碳储量的效率越高。</p><h2 id="主要图表解析"><a href="#主要图表解析" class="headerlink" title="主要图表解析"></a>主要图表解析</h2><h3 id="Fig-1-矿物结合态碳容量与土壤质地的关系"><a href="#Fig-1-矿物结合态碳容量与土壤质地的关系" class="headerlink" title="Fig. 1: 矿物结合态碳容量与土壤质地的关系"></a>Fig. 1: 矿物结合态碳容量与土壤质地的关系</h3><p><img src="https://fastly.jsdelivr.net/gh/bingoodog/picture@main/2026-01/fig1_1768487043714.png"></p><p>该图展示了矿物结合态有机碳（MOC）与黏粒+粉砂含量（CS）的关系，按高活性矿物和低活性矿物区分：</p><ul><li><strong>高活性矿物</strong>：具有更高的碳储存容量，MOC随CS增加的斜率更大</li><li><strong>低活性矿物</strong>：碳储存容量较低，MOC随CS增加的斜率较小</li><li><strong>95th分位数边界线</strong>：代表不同矿物类型的理论最大碳储存容量</li><li><strong>自然与管理生态系统</strong>：管理生态系统普遍低于自然生态系统的碳储存水平</li></ul><p>这一结果清晰地展示了矿物类型对土壤碳储存容量的决定性影响。</p><h3 id="Fig-2-不同生态系统和土壤深度的矿物结合态碳饱和度"><a href="#Fig-2-不同生态系统和土壤深度的矿物结合态碳饱和度" class="headerlink" title="Fig. 2: 不同生态系统和土壤深度的矿物结合态碳饱和度"></a>Fig. 2: 不同生态系统和土壤深度的矿物结合态碳饱和度</h3><p><img src="https://fastly.jsdelivr.net/gh/bingoodog/picture@main/2026-01/fig2_1768487041754.png"></p><p>箱线图显示了%C饱和度（MOC&#x2F;MOCmax）在不同条件下的分布：</p><ul><li><strong>管理生态系统 vs 自然生态系统</strong>：管理生态系统的饱和度显著低于自然生态系统</li><li><strong>不同生态系统类型</strong>：农田 &lt; 草原 &lt; 森林</li><li><strong>土壤深度效应</strong>：深层土壤的饱和度普遍低于表层土壤</li></ul><p>这一图表直观地展示了人类活动对土壤碳储存的影响，以及不同生态系统和土壤深度的固碳潜力差异。</p><h3 id="Fig-3-环境变量对矿物结合态碳的影响"><a href="#Fig-3-环境变量对矿物结合态碳的影响" class="headerlink" title="Fig. 3: 环境变量对矿物结合态碳的影响"></a>Fig. 3: 环境变量对矿物结合态碳的影响</h3><p><img src="https://fastly.jsdelivr.net/gh/bingoodog/picture@main/2026-01/fig3_1768487040439.png"></p><p>随机森林模型的偏依赖图揭示了：</p><ul><li><strong>颗粒有机碳（POC）</strong>：与MOC呈正相关，是MOC的重要来源</li><li><strong>年均温（MAT）</strong>：对MOC的影响受POC水平的调节</li><li><strong>土壤质地</strong>：黏粒+粉砂含量是决定MOC的关键因素</li></ul><p>这些结果帮助我们理解了环境变量如何共同调控矿物结合态有机碳的分布。</p><h3 id="Fig-4-全球矿物结合态碳容量、储量与固碳潜力"><a href="#Fig-4-全球矿物结合态碳容量、储量与固碳潜力" class="headerlink" title="Fig. 4: 全球矿物结合态碳容量、储量与固碳潜力"></a>Fig. 4: 全球矿物结合态碳容量、储量与固碳潜力</h3><p><img src="https://fastly.jsdelivr.net/gh/bingoodog/picture@main/2026-01/fig4_1768487037665.png"></p><p>这组全球地图（0.5°分辨率）展示了：</p><ul><li><strong>矿物结合态碳容量（MOCmax）</strong>：高值区主要分布在热带和温带湿润地区</li><li><strong>当前矿物结合态碳储量（MOC）</strong>：与MOCmax的空间分布相似，但数值普遍较低</li><li><strong>矿物结合态碳饱和度（%C saturation）</strong>：低饱和度区（高固碳潜力）主要分布在农业区域和干旱半干旱地区</li><li><strong>碳积累效率</strong>：基于103项观测数据，展示了饱和度与碳积累速率的非线性关系</li></ul><p>这组地图为识别全球固碳潜力热点区域提供了可视化工具。</p><h2 id="研究意义与启示"><a href="#研究意义与启示" class="headerlink" title="研究意义与启示"></a>研究意义与启示</h2><h3 id="科学意义"><a href="#科学意义" class="headerlink" title="科学意义"></a>科学意义</h3><ol><li><strong>填补全球尺度空白</strong>：首次提供了全球范围内矿物结合态有机碳储量和容量的定量评估</li><li><strong>深化机制理解</strong>：揭示了矿物类型、土壤深度和管理方式对矿物结合态碳分布的影响</li><li><strong>建立效率框架</strong>：建立了矿物结合态碳饱和度与碳积累效率的定量关系</li><li><strong>提供数据产品</strong>：生成了0.5°分辨率的全球MOC和MOCmax数据集</li></ol><h3 id="实践启示"><a href="#实践启示" class="headerlink" title="实践启示"></a>实践启示</h3><ol><li><strong>优先管理区域</strong>：农业管理区域和深层土壤具有最高的固碳潜力，应作为土壤碳管理的优先区域</li><li><strong>管理策略优化</strong>：针对不同饱和度的土壤，应采取不同的管理措施</li><li><strong>深度考虑</strong>：深层土壤的固碳潜力不容忽视，应将深层土壤纳入碳管理策略</li><li><strong>模型改进</strong>：研究结果可用于改进地球系统模型中的土壤碳循环模拟</li></ol><h2 id="数据与代码可用性"><a href="#数据与代码可用性" class="headerlink" title="数据与代码可用性"></a>数据与代码可用性</h2><p>全球矿物结合态有机碳和矿物学碳容量的栅格地图可在Zenodo免费获取：</p><ul><li>MOC和MOCmax栅格数据：<a href="https://doi.org/10.5281/zenodo.6539765">https://doi.org/10.5281/zenodo.6539765</a></li><li>观测合成数据：<a href="https://doi.org/10.5281/zenodo.5987415">https://doi.org/10.5281/zenodo.5987415</a></li><li>研究代码：<a href="https://doi.org/10.5281/zenodo.6539765">https://doi.org/10.5281/zenodo.6539765</a></li></ul><h2 id="结论与展望"><a href="#结论与展望" class="headerlink" title="结论与展望"></a>结论与展望</h2><p>这项研究为我们理解全球土壤碳储存能力提供了重要的科学依据。研究结果表明，全球土壤仍具有巨大的矿物结合态碳固存潜力，尤其是农业管理区域和深层土壤。通过合理的土壤管理措施，我们可以充分利用这一潜力，为应对气候变化做出贡献。</p><p>未来的研究方向包括：</p><ol><li>深入研究不同气候区和土壤类型下的矿物结合态碳形成机制</li><li>开发更精确的矿物结合态碳容量预测模型</li><li>评估不同管理措施对矿物结合态碳积累的长期影响</li><li>将矿物结合态碳纳入国家和全球碳核算体系</li></ol><hr><p><strong>文章引用</strong>：<br>Georgiou, K., Jackson, R.B., Vindušková, O. et al. Global stocks and capacity of mineral-associated soil organic carbon. Nat Commun 13, 3797 (2022). <a href="https://doi.org/10.1038/s41467-022-31540-9">https://doi.org/10.1038/s41467-022-31540-9</a></p>]]></content>
    
    
    <categories>
      
      <category>土壤科学</category>
      
    </categories>
    
    
    <tags>
      
      <tag>土壤有机碳</tag>
      
      <tag>矿物结合态有机碳</tag>
      
      <tag>碳固存潜力</tag>
      
      <tag>土壤管理</tag>
      
      <tag>气候变化</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>土壤有机碳反演方案</title>
    <link href="/2025/12/07/%E5%9C%9F%E5%A3%A4%E6%9C%89%E6%9C%BA%E7%A2%B3%E5%8F%8D%E6%BC%94%E6%96%B9%E6%A1%88/"/>
    <url>/2025/12/07/%E5%9C%9F%E5%A3%A4%E6%9C%89%E6%9C%BA%E7%A2%B3%E5%8F%8D%E6%BC%94%E6%96%B9%E6%A1%88/</url>
    
    <content type="html"><![CDATA[<h1 id="基于遥感和人工智能方法的土壤有机碳时空演变分析研究"><a href="#基于遥感和人工智能方法的土壤有机碳时空演变分析研究" class="headerlink" title="基于遥感和人工智能方法的土壤有机碳时空演变分析研究"></a>基于遥感和人工智能方法的土壤有机碳时空演变分析研究</h1><h2 id="1-研究目标"><a href="#1-研究目标" class="headerlink" title="1. 研究目标"></a>1. 研究目标</h2><ol><li><strong>构建数据集</strong>：建立”星-地”一体化的SOC反演特征数据库</li><li><strong>模型开发</strong>：比较并优选适用于该区域的AI反演模型（如RF, XGBoost）</li><li><strong>时空制图</strong>：生成过去25年（2000-2025）表层（0-10 cm或0-30cm）SOC空间分布图（分辨率500m&#x2F;1km）</li><li><strong>归因分析</strong>：解析气候变化（降水、温度）与人类活动（放牧、开垦）对SOC变化的相对贡献</li></ol><h2 id="2-数据来源"><a href="#2-数据来源" class="headerlink" title="2. 数据来源"></a>2. 数据来源</h2><p>基于SCORPAN模型理论框架选取环境变量。数字土壤制图反映的是土壤的空间分布特征和规律，土壤的空间分布是土壤形成与发展过程的体现，因而，数字土壤制图的一个理论基础是土壤成土因子学说。该学说认为土壤是母质、气候、生物、地形和时间5个成土因素综合作用的产物。</p><h3 id="表-1-SCORPAN特征分类体系"><a href="#表-1-SCORPAN特征分类体系" class="headerlink" title="表 1 SCORPAN特征分类体系"></a>表 1 SCORPAN特征分类体系</h3><table><thead><tr><th>SCORPAN</th><th>适用变量</th><th>作用机制</th></tr></thead><tbody><tr><td><strong>S（土壤）</strong></td><td>① 土壤 pH<br>② 土壤质地（黏粒&#x2F;砂粒百分比）<br>③ 容重</td><td>土壤普遍呈弱碱性，适宜微生物活动，提高SOC稳定性；黏粒可保护有机质不被分解；容重反映过度放牧造成的压实、根系输入减少。研究中通常可解释SOC（20-30%）的差异。</td></tr><tr><td><strong>C（气候）</strong></td><td>① 年均降水量（MAP）<br>② 年均温度（MAT）<br>③ 土壤湿度&#x2F;干旱指数</td><td>呈干旱梯度，降水是植被与微生物活动的主控因子；升温促进分解，增加SOC损失。气候因子在干旱区贡献较大。</td></tr><tr><td><strong>O（生物）</strong></td><td>① NDVI&#x2F;EVI<br>② 地上生物量（AGB）或NPP<br>③ 土地利用（放牧强度）</td><td>NDVI&#x2F;EVI反映生产力与根系输入；耕地化或重度放牧可使SOC下降。植被因子对SOC影响尤为显著。</td></tr><tr><td><strong>R（地形）</strong></td><td>① 高程<br>② 坡度<br>③ 坡向<br>④ 地形湿度指数（TWI）</td><td>海拔影响区域气候；坡度陡峭区更易发生侵蚀导致SOC流失；TWI可反映积水和微地形湿度。</td></tr></tbody></table><p>结合区域尺度建模对数据空间一致性、时间连续性和可获取性的要求选取数据集。数据源应完整覆盖成土因子，具备长期稳定、空间一致和多尺度适配等优势。</p><h3 id="表-2-数字土壤制图通用数据源"><a href="#表-2-数字土壤制图通用数据源" class="headerlink" title="表 2 数字土壤制图通用数据源"></a>表 2 数字土壤制图通用数据源</h3><table><thead><tr><th>数据类别</th><th>具体指标&#x2F;变量</th><th>数据来源</th><th>作用</th></tr></thead><tbody><tr><td>实测数据</td><td>SOC含量 (g&#x2F;100g)</td><td>① 公共数据库 (WoSIS)<br>② 文献挖掘 (从近5年发表论文中提取)<br>③ 自有采样数据</td><td>作为AI模型的训练集和验证集</td></tr><tr><td>光学遥感</td><td>植被指数 (NDVI, EVI), 裸土指数 (BSI)</td><td>MODIS (MOD13Q1) 或 Landsat 8&#x2F;9</td><td>表征地表植被生产力和裸露情况</td></tr><tr><td>气候数据</td><td>降水, 温度, 蒸散发, 土壤湿度</td><td>ERA5-Land 或 TerraClimate</td><td>关键的气候驱动因子</td></tr><tr><td>地形数据</td><td>高程, 坡度, 坡向, 地形湿度指数</td><td>SRTM 或 NASA DEM</td><td>影响水热再分配</td></tr><tr><td>微波遥感</td><td>后向散射系数 (VH&#x2F;VV)</td><td>Sentinel-1 (SAR)</td><td>补充光学遥感在云层覆盖下的缺失，反映土壤质地&#x2F;水分</td></tr></tbody></table><p>通过检索近十年关于土壤有机碳的文献，筛选出在区域尺度上被反复证明具有重要影响的特征因子。包括：放牧压力（以畜牧密度等指标表征）、植被生产力及其变化趋势（基于NDVI&#x2F;EVI的多年时序指标）、干旱程度（如蒸散与降水的比值或干旱指数）等。这些变量可依托遥感产品或再分析气候资料进行量化，从而在模型训练时更准确地反映独特的生态过程与碳循环驱动机制，有助于提升区域SOC反演的适应性与预测精度，并增强模型对驱动机制的解释能力。</p><h2 id="3-技术路线与方法"><a href="#3-技术路线与方法" class="headerlink" title="3. 技术路线与方法"></a>3. 技术路线与方法</h2><h3 id="3-1-数据与特征工程"><a href="#3-1-数据与特征工程" class="headerlink" title="3.1 数据与特征工程"></a>3.1 数据与特征工程</h3><ol><li><strong>数据标准化</strong>：收集WoSIS、文献中的剖面数据，进行统一的变量标准化（单位、深度标准化）。剔除异常剖面、统一土层厚度或按深度区间标准化SOC值。环境协变量标准化处理后进行栅格化。</li><li><strong>GEE处理</strong>：利用Google Earth Engine对MODIS&#x2F;Landsat数据进行去云、镶嵌、裁剪。构建多时相指标（NDVI、BSI、band ratios、短波红外波段等）。</li><li><strong>时空匹配</strong>：将地面采样点的经纬度和采样时间，与遥感影像像素进行时空匹配，提取对应的光谱和环境变量。</li><li><strong>特征筛选</strong>：使用递归特征消除(RFE)或皮尔逊相关性分析，剔除冗余变量，保留对SOC解释度最高的因子（通常是降水、NDVI、DEM）。</li></ol><h3 id="3-2-AI模型构建与优选"><a href="#3-2-AI模型构建与优选" class="headerlink" title="3.2 AI模型构建与优选"></a>3.2 AI模型构建与优选</h3><p>设计多模型对比实验，选择最优反演策略：</p><ol><li><strong>基准模型</strong>：随机森林 (Random Forest, RF)。适合处理高维非线性数据，且能输出特征重要性。</li><li><strong>进阶模型</strong>：XGBoost &#x2F; LightGBM。在处理稀疏数据时表现优异。</li><li><strong>深度学习</strong>：一维卷积神经网络 (1D-CNN)。输入光谱曲线特征，挖掘深层隐含关系。</li><li><strong>验证方法</strong>：采用10折交叉验证 (10-fold CV)，使用R2 (决定系数)、RMSE (均方根误差) 和 MAE (平均绝对误差) 评价精度。</li></ol><h3 id="3-3-时空演变分析"><a href="#3-3-时空演变分析" class="headerlink" title="3.3 时空演变分析"></a>3.3 时空演变分析</h3><ol><li><strong>反演制图</strong>：将训练好的最佳模型应用到整个区域的长时序影像上。</li><li><strong>趋势分析</strong>：计算Theil-Sen Median (森氏斜率)和Mann-Kendall (MK)趋势检验，判断SOC是显著增加、减少还是稳定。公式逻辑：如果Slope &gt; 0 且 P &lt; 0.05，则为显著增加。</li><li><strong>变异系数</strong>：通过计算各区域SOC含量的变异系数（CV），量化其空间异质性程度。</li></ol><h3 id="3-4-驱动机制归因"><a href="#3-4-驱动机制归因" class="headerlink" title="3.4 驱动机制归因"></a>3.4 驱动机制归因</h3><ol><li><strong>地理探测器 (Geodetector)</strong>：用于量化不同因子（如降水、放牧）对SOC空间分布的解释力（q值）及其交互作用。</li><li><strong>SHAP (SHapley Additive exPlanations) 值</strong>：用于解释AI模型，量化各因子（降水、温度、放牧强度等）对SOC的具体贡献度（正向或负向影响）。</li><li><strong>结构方程模型（SEM）</strong>：量化环境因子的相对作用强度及其潜在作用路径。</li></ol><h2 id="4-可行性与预期难点分析"><a href="#4-可行性与预期难点分析" class="headerlink" title="4. 可行性与预期难点分析"></a>4. 可行性与预期难点分析</h2><h3 id="4-1-可行性"><a href="#4-1-可行性" class="headerlink" title="4.1 可行性"></a>4.1 可行性</h3><ol><li><strong>数据可获取</strong>：GEE平台免费提供了海量遥感数据；WoSIS等全球土壤数据库提供了基础的训练样本。</li><li><strong>技术成熟</strong>：Python (Scikit-learn)和GEE API使得非计算机专业人员也能搭建机器学习流程。</li></ol><h3 id="4-2-潜在难点及解决方案"><a href="#4-2-潜在难点及解决方案" class="headerlink" title="4.2 潜在难点及解决方案"></a>4.2 潜在难点及解决方案</h3><ol><li><p><strong>跨国界数据不一致</strong></p><ul><li><strong>问题</strong>：草地管理政策不同，且采样数据密度不均。</li><li><strong>方案</strong>：在训练样本中进行加权重采样，确保样本平衡。</li></ul></li><li><p><strong>纯净裸土光谱获取难</strong></p><ul><li><strong>问题</strong>：植被覆盖遮挡了土壤光谱。</li><li><strong>方案</strong>：利用早春&#x2F;晚秋植被枯黄期的影像进行建模。</li></ul></li><li><p><strong>长时序传感器间差异</strong></p><ul><li><strong>问题</strong>：多源影像数据质量。</li><li><strong>方案</strong>：使用融合产品，例如Harmonized Landsat-Sentinel(HLS)。</li></ul></li></ol><h2 id="5-预期成果"><a href="#5-预期成果" class="headerlink" title="5. 预期成果"></a>5. 预期成果</h2><ol><li><strong>一张地图</strong>：2000-2025年SOC时空分布数据集（GeoTIFF格式）</li><li><strong>一份报告</strong>：揭示气候变化与人类活动（放牧、开垦）对碳库稳定性的影响</li></ol><h2 id="6-时间节点"><a href="#6-时间节点" class="headerlink" title="6. 时间节点"></a>6. 时间节点</h2><h3 id="表-3-进度安排"><a href="#表-3-进度安排" class="headerlink" title="表 3 进度安排"></a>表 3 进度安排</h3><table><thead><tr><th>编号</th><th>阶段</th><th>任务内容</th><th>第1月</th><th>第2月</th><th>第3月</th><th>第4月</th><th>第5月</th></tr></thead><tbody><tr><td>1</td><td>数据准备</td><td>数据收集；数据清洗；遥感影像下载；预处理（云掩膜、大气校正）</td><td>████████</td><td>████</td><td></td><td></td><td></td></tr><tr><td>2</td><td>特征工程</td><td>光谱指数、地形、气候；时间序列构建；特征筛选</td><td></td><td>████████</td><td>████</td><td></td><td></td></tr><tr><td>3</td><td>模型训练</td><td>RF&#x2F;XGBoost；训练与验证</td><td></td><td></td><td>████████</td><td>████</td><td></td></tr><tr><td>4</td><td>SOC制图</td><td>生成SOC空间图</td><td></td><td></td><td></td><td>████████</td><td></td></tr><tr><td>5</td><td>变化分析</td><td>多时相差值、趋势显著性检验</td><td></td><td></td><td></td><td></td><td>████</td></tr><tr><td>6</td><td>驱动归因</td><td>SHAP&#x2F;特征贡献；气候&#x2F;土地利用影响</td><td></td><td></td><td></td><td></td><td>████</td></tr><tr><td>7</td><td>成果整理</td><td>图件、产品、报告撰写</td><td></td><td></td><td></td><td></td><td>████████</td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>土壤科学</category>
      
    </categories>
    
    
    <tags>
      
      <tag>土壤有机碳</tag>
      
      <tag>遥感反演</tag>
      
      <tag>人工智能</tag>
      
      <tag>时空分析</tag>
      
      <tag>数字土壤制图</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>高分一号(GF-1)大气校正-基于py6s模型</title>
    <link href="/2024/09/30/%E9%AB%98%E5%88%86%E4%B8%80%E5%8F%B7%E5%A4%A7%E6%B0%94%E6%A0%A1%E6%AD%A3/"/>
    <url>/2024/09/30/%E9%AB%98%E5%88%86%E4%B8%80%E5%8F%B7%E5%A4%A7%E6%B0%94%E6%A0%A1%E6%AD%A3/</url>
    
    <content type="html"><![CDATA[<h1 id="高分一号大气校正实践指南"><a href="#高分一号大气校正实践指南" class="headerlink" title="高分一号大气校正实践指南"></a>高分一号大气校正实践指南</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>高分一号(GF-1)卫星是我国高分辨率对地观测系统重大专项的首发星，其数据在大气校正处理中需要注意一些特殊参数设置。本文将详细介绍基于py6s模型的大气校正方法，重点关注2022年后数据格式变化带来的参数调整。</p><blockquote><p>参考实现：<a href="https://github.com/Zhaoguanhua/AtmosphericCorrection">Zhaoguanhua&#x2F;AtmosphericCorrection</a></p></blockquote><h2 id="一、6S模型参数详解"><a href="#一、6S模型参数详解" class="headerlink" title="一、6S模型参数详解"></a>一、6S模型参数详解</h2><h3 id="1-1-几何参数设置"><a href="#1-1-几何参数设置" class="headerlink" title="1.1 几何参数设置"></a>1.1 几何参数设置</h3><p>6S模型中的几何参数对校正结果影响显著，需要特别注意高分一号数据头文件的变化：</p><ul><li><strong>2022年前数据</strong>：SolarZenith存储的是太阳高度角，需要转换为天顶角(90-高度角)</li><li><strong>2022年后数据</strong>：SolarZenith直接存储太阳天顶角，无需转换</li></ul><p>建议处理流程：</p><ol><li>使用ENVI国产卫星工具或<a href="https://data.cresda.cn/#/home">陆地观测卫星数据服务平台</a>确认数据版本</li><li>根据数据采集时间选择正确的参数处理方式</li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 几何参数设置示例</span><br>s.geometry = Geometry.User()<br><br><span class="hljs-comment"># 太阳位置参数</span><br><span class="hljs-comment"># 注意：2022年后数据SolarZenith已经是天顶角，无需90-转换</span><br>s.geometry.solar_z = <span class="hljs-built_in">float</span>(dom.getElementsByTagName(<span class="hljs-string">&#x27;SolarZenith&#x27;</span>)[<span class="hljs-number">0</span>].firstChild.data)<br>s.geometry.solar_a = <span class="hljs-built_in">float</span>(dom.getElementsByTagName(<span class="hljs-string">&#x27;SolarAzimuth&#x27;</span>)[<span class="hljs-number">0</span>].firstChild.data)<br><br><span class="hljs-comment"># 卫星观测几何参数</span><br><span class="hljs-comment"># 建议使用实际观测角度而非默认值(0,0)</span><br>s.geometry.view_z = <span class="hljs-built_in">float</span>(dom.getElementsByTagName(<span class="hljs-string">&#x27;SatelliteZenith&#x27;</span>)[<span class="hljs-number">0</span>].firstChild.data)<br>s.geometry.view_a = <span class="hljs-built_in">float</span>(dom.getElementsByTagName(<span class="hljs-string">&#x27;SatelliteAzimuth&#x27;</span>)[<span class="hljs-number">0</span>].firstChild.data)<br></code></pre></td></tr></table></figure><blockquote><p>参考阅读：<a href="https://blog.csdn.net/VickyChenVC/article/details/107861708">6S大气校正原理详解</a></p></blockquote><h3 id="1-2-大气与地表参数"><a href="#1-2-大气与地表参数" class="headerlink" title="1.2 大气与地表参数"></a>1.2 大气与地表参数</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 气溶胶类型设置</span><br><span class="hljs-comment"># 大陆型气溶胶适用于大多数内陆地区</span><br>s.aero_profile = AtmosProfile.PredefinedType(AeroProfile.Continental)<br><br><span class="hljs-comment"># 下垫面反射率</span><br><span class="hljs-comment"># 0.36为典型植被覆盖区值，可根据实际地表类型调整</span><br>s.ground_reflectance = GroundReflectance.HomogeneousLambertian(<span class="hljs-number">0.36</span>)<br><br><span class="hljs-comment"># 气溶胶光学厚度(AOT)</span><br><span class="hljs-comment"># 此值对应能见度约40km，晴天条件</span><br><span class="hljs-comment"># 可通过MODIS等气溶胶产品获取更精确值</span><br>s.aot550 = <span class="hljs-number">0.14497</span><br></code></pre></td></tr></table></figure><p><strong>参数选择建议</strong>：</p><ol><li>沿海地区考虑使用海洋型气溶胶(AeroProfile.Maritime)</li><li>城市区域可考虑使用城市型气溶胶(AeroProfile.Urban)</li><li>气溶胶光学厚度建议使用同步的MODIS或VIIRS产品</li></ol><h2 id="二、光谱响应函数更新"><a href="#二、光谱响应函数更新" class="headerlink" title="二、光谱响应函数更新"></a>二、光谱响应函数更新</h2><p>高分一号卫星的光谱响应函数(SRF)是大气校正的关键参数，需要定期更新以确保精度。</p><h3 id="2-1-获取最新参数"><a href="#2-1-获取最新参数" class="headerlink" title="2.1 获取最新参数"></a>2.1 获取最新参数</h3><p>官方资源下载：</p><ul><li><a href="https://www.cresda.com/zgzywxyyzx/zlxz/article/20240416163618563132683.html">定标系数与光谱响应函数</a></li><li><a href="https://data.cresda.cn/#/home">资源卫星应用中心数据下载</a></li></ul><h3 id="2-2-配置文件更新方法"><a href="#2-2-配置文件更新方法" class="headerlink" title="2.2 配置文件更新方法"></a>2.2 配置文件更新方法</h3><ol><li>编辑<code>RadiometricCorrectionParameter.json</code>文件</li><li>添加对应传感器和波段的参数：<ul><li>增益(Gain)和偏移(Offset)值</li><li>插值后的光谱响应函数(2.5nm间隔)</li></ul></li></ol><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-comment">// 示例配置结构</span><br><span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-attr">&quot;GF1&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;band1&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>      <span class="hljs-attr">&quot;gain&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0.123</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;offset&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0.045</span><span class="hljs-punctuation">,</span><br>      <span class="hljs-attr">&quot;srf&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-number">0.001</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.002</span><span class="hljs-punctuation">,</span> ...<span class="hljs-punctuation">]</span> <span class="hljs-comment">// 2.5nm间隔的SRF值</span><br>    <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-comment">// 其他波段...</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><blockquote><p>详细教程参考：<a href="https://blog.csdn.net/qq_15038823/article/details/140120644">高分卫星光谱响应函数自定义方法</a></p></blockquote>]]></content>
    
    
    <categories>
      
      <category>遥感数据处理</category>
      
      <category>大气校正</category>
      
    </categories>
    
    
    <tags>
      
      <tag>光谱响应函数</tag>
      
      <tag>py6s</tag>
      
      <tag>GF-1</tag>
      
      <tag>大气校正</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>高分一号（GF-1 WFV）批量预处理（ENVI）</title>
    <link href="/2024/09/01/%E9%AB%98%E5%88%86%E4%B8%80%E5%8F%B7%E9%A2%84%E5%A4%84%E7%90%86/"/>
    <url>/2024/09/01/%E9%AB%98%E5%88%86%E4%B8%80%E5%8F%B7%E9%A2%84%E5%A4%84%E7%90%86/</url>
    
    <content type="html"><![CDATA[<p>本文记录 <strong>GF-1 WFV</strong> 在 <strong>ENVI 5.5</strong> 下的批量预处理流程，包含：<strong>辅助数据准备 → 批量正射校正 → 批量辐射定标 → 批量 QUAC 大气校正</strong>。参数以“能批量稳定跑通”为优先，适合常规生产处理。</p><hr><h2 id="0-准备工作（建议先检查）"><a href="#0-准备工作（建议先检查）" class="headerlink" title="0. 准备工作（建议先检查）"></a>0. 准备工作（建议先检查）</h2><ul><li><strong>软件&#x2F;版本</strong>：ENVI 5.5（或同系列版本，菜单名称可能略有差异）</li><li><strong>输入数据</strong>：GF1_WFV 原始影像（确保元数据齐全）</li><li><strong>输出规划</strong>：建议分阶段输出到不同文件夹，避免覆盖与回溯困难，例如：<ul><li><code>01_ortho/</code>（正射）</li><li><code>02_calib/</code>（定标）</li><li><code>03_quac/</code>（大气校正）</li></ul></li></ul><hr><h2 id="1-辅助数据"><a href="#1-辅助数据" class="headerlink" title="1. 辅助数据"></a>1. 辅助数据</h2><p>在进行 GF1_WFV 预处理前，需要准备以下辅助数据：</p><h3 id="1-1-参考影像"><a href="#1-1-参考影像" class="headerlink" title="1.1 参考影像"></a>1.1 参考影像</h3><ul><li><strong>Landsat 8 全色波段拼接影像</strong>（用于自动找点&#x2F;配准参考）</li></ul><h3 id="1-2-DEM"><a href="#1-2-DEM" class="headerlink" title="1.2 DEM"></a>1.2 DEM</h3><ul><li><strong>数字高程模型（DEM）</strong>  <blockquote><p>注意：<strong>建议使用外部下载的 DEM</strong>，不要使用 ENVI 自带 DEM（在部分区域&#x2F;分辨率条件下更容易出现匹配或精度问题）。</p></blockquote></li></ul><p>从服务器下载辅助数据到本地（示例）：</p><p><img src="https://fastly.jsdelivr.net/gh/bingoodog/picture@main/2025-07/250715133253415_1752557573445.png"></p><hr><h2 id="2-正射校正（批处理）"><a href="#2-正射校正（批处理）" class="headerlink" title="2. 正射校正（批处理）"></a>2. 正射校正（批处理）</h2><h3 id="2-1-安装插件"><a href="#2-1-安装插件" class="headerlink" title="2.1 安装插件"></a>2.1 安装插件</h3><p>在 ENVI <strong>App Store</strong> 搜索并安装以下插件：</p><ul><li><strong>中国国产卫星支持工具</strong></li><li><strong>ENVI55 自动找点正射校正批处理工具</strong></li></ul><p><img src="https://fastly.jsdelivr.net/gh/bingoodog/picture@main/2025-07/250715133320766_1752557600800.png"></p><h3 id="2-2-打开数据并自动识别元数据"><a href="#2-2-打开数据并自动识别元数据" class="headerlink" title="2.2 打开数据并自动识别元数据"></a>2.2 打开数据并自动识别元数据</h3><p>使用 <strong>中国国产卫星支持工具</strong> 打开 GF1_WFV 数据，确认系统已自动识别元数据（RPC 等信息）。</p><p><img src="https://fastly.jsdelivr.net/gh/bingoodog/picture@main/2025-07/250715133341888_1752557621905.png"></p><h3 id="2-3-批量正射：RPC-Orthorectification"><a href="#2-3-批量正射：RPC-Orthorectification" class="headerlink" title="2.3 批量正射：RPC Orthorectification"></a>2.3 批量正射：RPC Orthorectification</h3><p>打开工具：<strong>RPC Orthorectification Using Reference Image Batch</strong>。</p><p><img src="https://fastly.jsdelivr.net/gh/bingoodog/picture@main/2025-07/250715133453595_1752557693616.png"></p><h4 id="参数设置要点（建议）"><a href="#参数设置要点（建议）" class="headerlink" title="参数设置要点（建议）"></a>参数设置要点（建议）</h4><ul><li><strong>输入数据</strong>：选择 GF1_WFV 影像（可多景）</li><li><strong>Reference Image</strong>：Landsat 8 全色拼接影像</li><li><strong>DEM</strong>：选择从服务器下载的 DEM（不建议用 ENVI 自带 DEM）</li><li><strong>输出像元大小&#x2F;参数</strong>：<strong>输出大小选择 16</strong>（按你的生产规范）</li><li><strong>输出路径</strong>：指向 <code>01_ortho/</code>（建议单独目录）</li><li>其余参数：可先保持默认，确保批处理稳定完成</li></ul><p><img src="https://fastly.jsdelivr.net/gh/bingoodog/picture@main/2025-07/250715133533797_1752557733814.png"></p><hr><h2 id="3-大气校正（定标-QUAC）"><a href="#3-大气校正（定标-QUAC）" class="headerlink" title="3. 大气校正（定标 + QUAC）"></a>3. 大气校正（定标 + QUAC）</h2><h3 id="3-1-批量辐射定标"><a href="#3-1-批量辐射定标" class="headerlink" title="3.1 批量辐射定标"></a>3.1 批量辐射定标</h3><h4 id="3-1-1-安装插件"><a href="#3-1-1-安装插件" class="headerlink" title="3.1.1 安装插件"></a>3.1.1 安装插件</h4><p>在 ENVI <strong>App Store</strong> 搜索并安装：</p><ul><li><strong>新版图像批处理工具包 V5.5</strong></li></ul><p><img src="https://fastly.jsdelivr.net/gh/bingoodog/picture@main/2025-07/250715133940671_1752557980695.png"></p><h4 id="3-1-2-批量定标操作"><a href="#3-1-2-批量定标操作" class="headerlink" title="3.1.2 批量定标操作"></a>3.1.2 批量定标操作</h4><ul><li><strong>输入数据</strong>：选择上一步正射校正输出（<code>01_ortho/</code>）</li><li><strong>参数</strong>：通常保持默认即可</li><li><strong>输出路径</strong>：建议指向 <code>02_calib/</code></li></ul><blockquote><p>备注：本文流程使用 <strong>QUAC</strong> 进行大气校正，<strong>不需要</strong>按 FLAASH 的方式配置大气模型参数。</p></blockquote><p><img src="https://fastly.jsdelivr.net/gh/bingoodog/picture@main/2025-07/250715134005204_1752558005232.png"></p><hr><h3 id="3-2-批量快速大气校正（QUAC）"><a href="#3-2-批量快速大气校正（QUAC）" class="headerlink" title="3.2 批量快速大气校正（QUAC）"></a>3.2 批量快速大气校正（QUAC）</h3><ul><li><strong>输入数据</strong>：选择定标后输出（<code>02_calib/</code>）</li><li><strong>方法</strong>：QUAC（Quick Atmospheric Correction）</li><li><strong>参数</strong>：一般保持默认</li><li><strong>输出路径</strong>：建议指向 <code>03_quac/</code></li></ul><p><img src="https://fastly.jsdelivr.net/gh/bingoodog/picture@main/2025-07/250715134027354_1752558027389.png"></p><hr><h2 id="4-结果检查"><a href="#4-结果检查" class="headerlink" title="4. 结果检查"></a>4. 结果检查</h2><p>为避免“批量跑完但结果不可用”，建议抽查：</p><ul><li><strong>空间位置</strong>：与参考影像叠加检查偏移（边界、道路、水体等）</li><li><strong>NoData&#x2F;黑边</strong>：是否存在异常范围扩张或裁切问题</li><li><strong>影像值域</strong>：定标后、QUAC 后直方图是否合理（避免全黑&#x2F;全白）</li></ul><hr><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul><li><a href="https://www.cnblogs.com/enviidl/p/16553338.html">大气校正</a></li><li><a href="https://www.cnblogs.com/enviidl/p/16542676.html">正射校正</a></li><li><a href="https://blog.csdn.net/qq_42121168/article/details/115464531">高分数据预处理</a></li></ul>]]></content>
    
    
    <categories>
      
      <category>遥感数据处理</category>
      
      <category>大气校正</category>
      
    </categories>
    
    
    <tags>
      
      <tag>GF-1</tag>
      
      <tag>ENVI</tag>
      
      <tag>QUAC</tag>
      
      <tag>批处理</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>高分对地观测比赛水体赛道-实现方案分享</title>
    <link href="/2023/09/29/%E9%AB%98%E5%88%86%E5%AF%B9%E5%9C%B0%E8%A7%82%E6%B5%8B%E6%AF%94%E8%B5%9B2023/"/>
    <url>/2023/09/29/%E9%AB%98%E5%88%86%E5%AF%B9%E5%9C%B0%E8%A7%82%E6%B5%8B%E6%AF%94%E8%B5%9B2023/</url>
    
    <content type="html"><![CDATA[<h1 id="基于深度学习的南漪湖水质参数反演研究"><a href="#基于深度学习的南漪湖水质参数反演研究" class="headerlink" title="基于深度学习的南漪湖水质参数反演研究"></a>基于深度学习的南漪湖水质参数反演研究</h1><p><strong>摘 要：</strong> 本研究采用多层感知器（MLP）神经网络模型、k 折交叉验证和遗传算法优化神经网络的方法，对水质参数进行反演，并生成了水质参数反演产品。实验结果表明，该方法在非线性拟合能力和泛化能力方面表现良好。</p><p><strong>关键词：</strong> 水质参数反演；多层感知器；k 折交叉验证；遗传算法</p><h2 id="1-引言"><a href="#1-引言" class="headerlink" title="1 引言"></a>1 引言</h2><p>叶绿素是水体中的重要生物标志物，可以提供有关水体健康状态和环境变化的关键信息。因此，准确测量和反演叶绿素浓度对于环境监测、水质评估以及生态系统管理至关重要。在过去的几十年中，许多传统的光谱分析方法被广泛应用于叶绿素浓度反演。然而，这些方法通常依赖于复杂的光学模型和经验参数化，且对于光谱数据的处理和解释存在一定的局限性。</p><p>近年来，深度学习作为一种强大的机器学习方法，逐渐在遥感数据处理领域展现出巨大的潜力。深度学习算法可以自动学习数据中的复杂特征和模式，无需依赖传统手动设计的特征提取方法。这为叶绿素浓度反演提供了一种新的可能性，通过光谱数据学习光谱特征与叶绿素浓度之间的关系。</p><p>本文旨在基于深度学习方法探索光谱数据与叶绿素浓度之间的关系，并实现高精度的叶绿素浓度反演。针对该问题，本文提出了一种基于深度学习的反演模型，通过捕捉光谱数据中的潜在特征并建立与水质参数之间的映射关系，并对反演结果进行分析以验证其有效性。</p><h2 id="2-数据处理"><a href="#2-数据处理" class="headerlink" title="2 数据处理"></a>2 数据处理</h2><h3 id="2-1-实测数据处理"><a href="#2-1-实测数据处理" class="headerlink" title="2.1 实测数据处理"></a>2.1 实测数据处理</h3><p>采用高斯核回归平滑和等效反射率转换来处理实测光谱数据。具体步骤如下：将实测光谱数据进行高斯核回归平滑，以去除噪声和杂波。使用光谱响应函数将实测光谱数据转换为等效反射率数据。</p><h3 id="2-2-影像数据处理"><a href="#2-2-影像数据处理" class="headerlink" title="2.2 影像数据处理"></a>2.2 影像数据处理</h3><p>影像数据处理主要包括辐射定标和大气校正以及正射校正等步骤。对影像数据进行辐射定标，将原始影像数据转换为辐射亮度数据。使用大气校正方法，消除大气吸收和散射对影像的影响。进行正射校正，以消除地形和倾斜度对影像的影响。使得影像数据更加准确和可靠，方便后续的处理和分析。</p><h3 id="2-3-水体提取"><a href="#2-3-水体提取" class="headerlink" title="2.3 水体提取"></a>2.3 水体提取</h3><p>水体提取是水质参数反演的前提步骤，本文使用 EIseg 高精度分割模型进行水体提取。使用马尔可夫优化方法对分割结果进行进一步的优化和精细化处理，以提高水体提取的准确性。</p><h3 id="2-4-水面遥感反射率估算方法"><a href="#2-4-水面遥感反射率估算方法" class="headerlink" title="2.4 水面遥感反射率估算方法"></a>2.4 水面遥感反射率估算方法</h3><p>FLAASH 处理后的地表反射率，需要去除天空光的影响，才能获得遥感反射率。</p><p>$$<br>R_{\mathrm{rs}}^c(\lambda)&#x3D;\frac{\rho(\lambda)-\min(\rho_{\mathrm{NIR}},\rho_{\mathrm{SWIR}})}{\pi}<br>$$</p><p>其中，$R_{\mathrm{rs}}^c(\lambda)$ 代表图像上近似估计的遥感反射率，$\rho(\lambda)$ 表示地表反射率，$\min(\rho_{\mathrm{NIR}},\rho_{\mathrm{SWIR}})$ 表示近红外和短波红外地表反射率的较小值。考虑到高分一号数据的特性，本文将地表反射率值除以 $\pi$ 近似估计为遥感反射率。</p><h3 id="2-5-经验线性校正"><a href="#2-5-经验线性校正" class="headerlink" title="2.5 经验线性校正"></a>2.5 经验线性校正</h3><p>高分一号与哨兵二号的波段设置接近，且哨兵二号影像时空分辨率较高，使用与实测数据同步的哨兵二号影像建立经验线性模型来校正哨兵二号的反射率值，以校正之后的哨兵二号影像为基准，对高分一号影像进行相对辐射归一化校正，得到校正之后的高分一号反射率值用于后续模型训练与推理。</p><p>综上所述，本文对实测数据和影像数据进行了预处理，为后续的水质参数反演提供了可靠的数据基础。</p><h2 id="3-研究方法"><a href="#3-研究方法" class="headerlink" title="3 研究方法"></a>3 研究方法</h2><h3 id="3-1-MLP-神经网络原理"><a href="#3-1-MLP-神经网络原理" class="headerlink" title="3.1 MLP 神经网络原理"></a>3.1 MLP 神经网络原理</h3><p>多层感知器（MLP）神经网络是一种前向反馈神经网络，由输入层、隐藏层和输出层组成。每一层都包括多个神经元，神经元之间通过权重进行连接，通过激活函数将输入信号转换为输出信号。</p><p>在 MLP 神经网络中，输入层接收输入数据，隐藏层进行特征提取和抽象，输出层进行结果输出。通过不断调整权重和偏置，使得神经网络能够学习输入数据的特征和规律，实现对复杂问题的建模和预测。</p><h3 id="3-2-k-折交叉验证"><a href="#3-2-k-折交叉验证" class="headerlink" title="3.2 k 折交叉验证"></a>3.2 k 折交叉验证</h3><p>k 折交叉验证是一种常用的评估方法，用于评估机器学习模型的泛化能力和预测精度。通过将数据集分为 k 个子集，每次用其中 k-1 个子集作为训练集，剩余一个子集作为测试集，进行模型训练和评估。重复 k 次，每次选取不同的测试集，最终得到平均交叉验证误差，以评估模型的泛化能力和预测精度。</p><h3 id="3-3-遗传算法原理"><a href="#3-3-遗传算法原理" class="headerlink" title="3.3 遗传算法原理"></a>3.3 遗传算法原理</h3><p>遗传算法是一种基于自然选择和遗传机制的优化算法，常用于求解复杂问题的全局最优解。遗传算法模拟生物进化的过程，通过选择、交叉和变异等操作，不断优化和进化种群中的优秀个体，最终得到全局最优解。</p><h3 id="3-4-遗传算法优化神经网络"><a href="#3-4-遗传算法优化神经网络" class="headerlink" title="3.4 遗传算法优化神经网络"></a>3.4 遗传算法优化神经网络</h3><p>在本文中，使用遗传算法对神经网络的超参数进行优化，以提高模型的泛化能力和反演精度。将神经网络隐藏层的神经元个数作为染色体，通过选择、交叉和变异等操作，优化神经网络隐藏层神经元个数。</p><h3 id="3-5-技术路线"><a href="#3-5-技术路线" class="headerlink" title="3.5 技术路线"></a>3.5 技术路线</h3><p><img src="https://fastly.jsdelivr.net/gh/bingoodog/picture@main/2026-01/260116200152200_1768564912227.png"></p><h2 id="4-结果与分析"><a href="#4-结果与分析" class="headerlink" title="4 结果与分析"></a>4 结果与分析</h2><h3 id="4-1-模型训练与精度评估"><a href="#4-1-模型训练与精度评估" class="headerlink" title="4.1 模型训练与精度评估"></a>4.1 模型训练与精度评估</h3><p>采用了 k 折交叉验证的方法对 MLP 神经网络模型进行训练和评估。同时，采用遗传算法对神经网络的超参数进行优化，以提高模型的泛化能力和反演精度。</p><p>经过不断调整参数和优化模型，得到了反演精度较高的模型。并在测试集上进行了精度评估，使用均方误差和平均绝对误差作为评价指标来评估反演结果的精度和准确性。</p><h3 id="4-2-反演产品生成"><a href="#4-2-反演产品生成" class="headerlink" title="4.2 反演产品生成"></a>4.2 反演产品生成</h3><p>将影像数据转为模型可接受的数据格式输入到模型中进行推理，并将推理结果写入 tiff 生成了水质参数反演产品，如图 1、2 所示。反演产品能够直观地反映水质参数的空间分布和变化趋势，为水质监测和管理提供重要的参考和支持。</p><div align="center">  <img src="https://fastly.jsdelivr.net/gh/bingoodog/picture@main/2026-01/260116200528287_1768565128331.png" alt="叶绿素浓度分布图" />  <br />  <strong>图 1 叶绿素浓度分布图</strong></div><div align="center">  <img src="https://fastly.jsdelivr.net/gh/bingoodog/picture@main/2026-01/260116200534667_1768565134688.png" alt="悬浮物浓度分布图" />  <br />  <strong>图 2 悬浮物浓度分布图</strong></div><p>综上所述，本文基于 MLP 神经网络模型反演了水质参数，并生成了水质参数反演产品。这一方法具有一定的反演精度和可靠性，能够为水质监测和管理提供重要的参考和支持。</p><h2 id="5-结论"><a href="#5-结论" class="headerlink" title="5 结论"></a>5 结论</h2><p>本文采用了基于 MLP 神经网络模型、k 折交叉验证和遗传算法优化神经网络的方法，对水质参数进行反演，并生成了水质参数反演产品。</p><p>在 MLP 神经网络模型中，采用了多层结构，隐藏层数目通过遗传算法确定。使用 LeakyReLU 激活函数和 Adam 优化算法，对神经网络进行训练和优化。在评估函数方面，使用了均方误差和平均绝对误差作为反演精度的评价指标。</p><p>通过对 MLP 神经网络模型的训练和调优，得到了反演精度较好的结果。根据反演结果生成了水质参数反演产品，能够直观地反映水质参数的空间分布和变化趋势。</p><p>在本文的研究过程中还存在一些不足之处。由于数据量和监测点分布的限制，反演结果存在一定的不确定性和局限性。水面遥感反射率的计算使用的是一种经验线性估计算法，和实测值之间存在一定的偏差，反演结果很大程度上由数据的精度决定，应该构建具有物理意义的模型来校正 FLAASH 大气校正的结果。使用的是基于 MLP 神经网络的反演模型，对于较为复杂的水质参数反演问题，可能需要采用更加高级的模型和算法。最后，生成的反演结果仅仅是一种预测结果，需要进一步结合实际监测数据和情况进行分析和验证。</p><p>综上所述，本文采用了基于 MLP 神经网络的反演模型和 k 折交叉验证、遗传算法的评估方法，对水质参数进行反演，并生成了水质参数反演产品。这一方法具有较强的非线性拟合能力和泛化能力，能够有效提高水质参数反演的精度和可靠性。同时，研究存在一些不足和局限性，需要进一步完善和优化。</p><h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><p>[1] 徐逸, 董轩妍, 王俊杰. 4 种机器学习模型反演太湖叶绿素 a 浓度的比较[J]. 水生态学杂志, 2019, 40(04): 48-57.</p><p>[2] 董舜丹. 基于深度学习的南海近海海域叶绿素a浓度反演研究[D]. 桂林理工大学, 2022</p><p>[3] 熊远康, 范冬林, 何宏昌, 等. 基于Landsat 8影像的Himawari-8叶绿素a空间降尺度研究[J]. 中国环境科学, 2022, 42(11): 5341-5350.</p><p>[4] 于博文. 基于深度学习的VIIRS卫星全球海洋叶绿素a浓度反演[D]. 中国地质大学(北京), 2019</p><p>[5] 孙茜童. 基于深度学习的叶绿素浓度反演研究[D]. 长春理工大学, 2022</p><p>[6] 卢雪梅, 苏华. 基于OLCI数据的福建近海悬浮物浓度遥感反演[J]. 环境科学学报, 2020, 40(08): 2819-2827.</p><p>[7] 谢婷婷, 陈芸芝, 卢文芳, 等. 面向GF-1 WFV数据的闽江下游叶绿素a反演模型研究[J]. 环境科学学报, 2019, 39(12): 4276-4283.</p><p>[8] 王林, 王祥, 王新新, 等. 基于Sentinel-3 OLCI影像的秦皇岛海域悬浮物浓度遥感反演[J]. 中国环境科学, 2022, 42(08): 3867-3875.</p><h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>这时候刚开始接触定量遥感，很多东西都是摸索着做的，这里的方案现在看来全是漏洞。不过，先完成在完善吧。🤣</p>]]></content>
    
    
    <categories>
      
      <category>竞赛</category>
      
    </categories>
    
    
    <tags>
      
      <tag>水质参数反演</tag>
      
      <tag>叶绿素</tag>
      
      <tag>悬浮物</tag>
      
      <tag>MLP</tag>
      
      <tag>K折交叉验证</tag>
      
      <tag>遗传算法</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>等效遥感反射率转换：从实测光谱到传感器波段的实现</title>
    <link href="/2023/06/12/%E7%AD%89%E6%95%88%E9%81%A5%E6%84%9F%E5%8F%8D%E5%B0%84%E7%8E%87%E8%BD%AC%E6%8D%A2/"/>
    <url>/2023/06/12/%E7%AD%89%E6%95%88%E9%81%A5%E6%84%9F%E5%8F%8D%E5%B0%84%E7%8E%87%E8%BD%AC%E6%8D%A2/</url>
    
    <content type="html"><![CDATA[<h2 id="📖-背景与意义"><a href="#📖-背景与意义" class="headerlink" title="📖 背景与意义"></a>📖 背景与意义</h2><p>在遥感应用中，由于光谱分辨率、空间分辨率、大气影响等因素，野外实验获取的地面实测高光谱数据与卫星影像光谱数据存在一定差异。实现两者的有效转换和比对对于确保遥感数据质量和水质反演精度具有重要意义。</p><p>光谱重采样技术可以将实测反射率数据拟合到传感器特定波段宽度，而大气校正可以降低卫星影像的大气影响。通过等效反射率转换，我们能够实现<strong>星地准同步观测的统一</strong>，为后续的水质参数反演提供可靠的数据基础<sup id="fnref:1" class="footnote-ref"><a href="#fn:1" rel="footnote"><span class="hint--top hint--rounded" aria-label="孔祥生, 张安定, 钱永刚, 董宇阳. (2011). 地物光谱反射率测量与行星反射率计算联合教学设计与实践. *测绘科学*, 36(5), 234-236. DOI: 10.16251/j.cnki.1009-2307.2011.05.087">[1]</span></a></sup>。</p><h2 id="🧮-理论基础"><a href="#🧮-理论基础" class="headerlink" title="🧮 理论基础"></a>🧮 理论基础</h2><h3 id="转换公式"><a href="#转换公式" class="headerlink" title="转换公式"></a>转换公式</h3><p>等效遥感反射率转换的核心公式如下：</p><p>$$<br>\rho_{rs}(\lambda_i) &#x3D; \frac{\int_{\lambda_1}^{\lambda_2} \rho(\lambda) \cdot SRF(\lambda)  d\lambda}{\int_{\lambda_1}^{\lambda_2} SRF(\lambda)  d\lambda}<br>$$</p><p><strong>公式参数说明：</strong></p><ul><li>$\rho_{rs}(\lambda_i)$：传感器第 $i$ 波段中心波长 $\lambda_i$ 处的窄波段反射率</li><li>$\rho(\lambda)$：实测光谱在波长 $\lambda$ 处的反射率</li><li>$\lambda_1, \lambda_2$：传感器第 $i$ 波段的波长范围</li><li>$SRF(\lambda)$：传感器的光谱响应函数</li></ul><h2 id="🛠️-Python代码实现"><a href="#🛠️-Python代码实现" class="headerlink" title="🛠️ Python代码实现"></a>🛠️ Python代码实现</h2><p>以下代码实现了从高光谱反射率到等效遥感反射率的完整转换过程：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">## 等效遥感反射率计算##</span><br><br><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><br><span class="hljs-comment"># 手动输入文件名</span><br>inputrrs = <span class="hljs-string">r&quot;\实测.xlsx&quot;</span>  <span class="hljs-comment"># 高光谱反射率excel文件名</span><br>inputSRF = <span class="hljs-string">r&quot;\WFV1.xlsx&quot;</span>  <span class="hljs-comment"># 卫星光谱响应函数excel文件名</span><br>output = <span class="hljs-string">r&quot;\WFV1.xlsx&quot;</span>  <span class="hljs-comment"># 设置输出等效遥感反射率文件名</span><br><br><span class="hljs-comment"># 读取数据</span><br><span class="hljs-keyword">try</span>:<br>    Rrs = pd.read_excel(inputrrs, header=<span class="hljs-literal">None</span>).values  <span class="hljs-comment"># 读取高光谱遥感反射率Rrs</span><br>    SRF = pd.read_excel(inputSRF, header=<span class="hljs-literal">None</span>).values  <span class="hljs-comment"># 读取传感器光谱响应函数SRF</span><br><span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;&gt;&gt;&gt;&gt;&gt;&gt;&gt;读取失败，请检查Rrs与SRF的excel文件名是否有误&lt;&lt;&lt;&lt;&lt;&lt;&lt;&#x27;</span>)<br>    <span class="hljs-keyword">raise</span> e<br><br>sn = Rrs[<span class="hljs-number">0</span>, <span class="hljs-number">1</span>:]  <span class="hljs-comment"># 站点名station name</span><br>bn = SRF[<span class="hljs-number">0</span>, <span class="hljs-number">1</span>:]  <span class="hljs-comment"># 波段名band name</span><br><br>Rrs = Rrs[<span class="hljs-number">1</span>:, :].astype(<span class="hljs-built_in">float</span>)<br>SRF = SRF[<span class="hljs-number">1</span>:, :].astype(<span class="hljs-built_in">float</span>)<br><br>c1 = Rrs.shape[<span class="hljs-number">1</span>]  <span class="hljs-comment"># 高光谱反射率矩阵大小</span><br>c2 = SRF.shape[<span class="hljs-number">1</span>]  <span class="hljs-comment"># SRF矩阵大小</span><br><br><span class="hljs-comment"># 将光谱响应函数中可能存在的NaN值与小于0的值变为0</span><br>SRF[np.isnan(SRF)] = <span class="hljs-number">0</span><br>SRF[SRF &lt; <span class="hljs-number">0</span>] = <span class="hljs-number">0</span><br>Rrs[np.isnan(Rrs)] = <span class="hljs-number">0</span><br>Rrs[Rrs &lt; <span class="hljs-number">0</span>] = <span class="hljs-number">0</span><br><br><span class="hljs-comment"># 计算等效Rrs</span><br>er = np.zeros((c2 - <span class="hljs-number">1</span>, c1 - <span class="hljs-number">1</span>))  <span class="hljs-comment"># 创建存储等效Rrs的矩阵</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, c2):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, c1):<br>        l1 = np.nonzero(SRF[:, i])[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]  <span class="hljs-comment"># 积分下限</span><br>        l2 = np.nonzero(SRF[:, i])[<span class="hljs-number">0</span>][-<span class="hljs-number">1</span>]  <span class="hljs-comment"># 积分上限</span><br>        er[i - <span class="hljs-number">1</span>, j - <span class="hljs-number">1</span>] = (np.trapz(Rrs[np.where(Rrs[:, <span class="hljs-number">0</span>] == SRF[l1, <span class="hljs-number">0</span>])[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]:np.where(Rrs[:, <span class="hljs-number">0</span>] == SRF[l2, <span class="hljs-number">0</span>])[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] + <span class="hljs-number">1</span>, j] * SRF[l1:l2 + <span class="hljs-number">1</span>, i], dx=<span class="hljs-number">1</span>)) / (np.trapz(SRF[l1:l2 + <span class="hljs-number">1</span>, i], dx=<span class="hljs-number">1</span>))<br><br><span class="hljs-comment"># 数据保存</span><br><span class="hljs-comment"># 创建标好站点名和波段名的excel</span><br>temp = np.empty((c2, c1), dtype=<span class="hljs-built_in">object</span>)<br>temp[<span class="hljs-number">0</span>, <span class="hljs-number">1</span>:] = sn  <span class="hljs-comment"># 第一行是站点名</span><br>temp[<span class="hljs-number">1</span>:, <span class="hljs-number">0</span>] = bn  <span class="hljs-comment"># 第一列是波段名</span><br>temp[<span class="hljs-number">1</span>:, <span class="hljs-number">1</span>:] = er<br><br><span class="hljs-comment"># 输出</span><br>df = pd.DataFrame(temp)<br>df.to_excel(output, index=<span class="hljs-literal">False</span>, header=<span class="hljs-literal">False</span>)<br></code></pre></td></tr></table></figure><h2 id="📊-数据格式示例"><a href="#📊-数据格式示例" class="headerlink" title="📊 数据格式示例"></a>📊 数据格式示例</h2><h3 id="1-高光谱反射率数据-实测-xlsx"><a href="#1-高光谱反射率数据-实测-xlsx" class="headerlink" title="1. 高光谱反射率数据 (实测.xlsx)"></a>1. 高光谱反射率数据 (<code>实测.xlsx</code>)</h3><table><thead><tr><th>WaveLength</th><th>Station 1</th><th>Station 2</th><th>Station 3</th><th>Station 4</th><th>Station 5</th></tr></thead><tbody><tr><td>400</td><td>0.0098442</td><td>0.0097718</td><td>0.0096756</td><td>0.0102083</td><td>0.0100013</td></tr><tr><td>401</td><td>0.0097854</td><td>0.0097617</td><td>0.0096686</td><td>0.0101987</td><td>0.0099884</td></tr></tbody></table><h3 id="2-光谱响应函数-SRF-xlsx"><a href="#2-光谱响应函数-SRF-xlsx" class="headerlink" title="2. 光谱响应函数 (SRF.xlsx)"></a>2. 光谱响应函数 (<code>SRF.xlsx</code>)</h3><table><thead><tr><th>波长&#x2F;nm</th><th>B1</th><th>B2</th><th>B3</th><th>B4</th></tr></thead><tbody><tr><td>400</td><td>0.000282</td><td>0.000558</td><td>0.000706</td><td>0.000130</td></tr><tr><td>401</td><td>0.000269</td><td>0.000488</td><td>0.000757</td><td>0.000114</td></tr></tbody></table><h3 id="3-输出结果-WFV1-xlsx"><a href="#3-输出结果-WFV1-xlsx" class="headerlink" title="3. 输出结果 (WFV1.xlsx)"></a>3. 输出结果 (<code>WFV1.xlsx</code>)</h3><table><thead><tr><th>站点</th><th>B1</th><th>B2</th><th>B3</th><th>B4</th></tr></thead><tbody><tr><td>Station 1</td><td>0.013824</td><td>0.024703</td><td>0.017775</td><td>0.008289</td></tr><tr><td>Station 2</td><td>0.016768</td><td>0.022395</td><td>0.016537</td><td>0.003900</td></tr></tbody></table><h2 id="💡-应用价值与注意事项"><a href="#💡-应用价值与注意事项" class="headerlink" title="💡 应用价值与注意事项"></a>💡 应用价值与注意事项</h2><h3 id="🌟-技术优势"><a href="#🌟-技术优势" class="headerlink" title="🌟 技术优势"></a>🌟 技术优势</h3><ol><li><strong>数据替代性</strong>：当缺少同步过境影像或影像质量不佳时，可用等效反射率替代影像反射率进行水质反演</li><li><strong>效率提升</strong>：只需人工测量水质参数，通过影像反射率即可完成反演，减少实测光谱工作量</li><li><strong>精度改善</strong>：结合实测光谱与遥感影像反射率，能有效提升水质反演的精度和可靠性</li></ol><h3 id="⚠️-注意事项"><a href="#⚠️-注意事项" class="headerlink" title="⚠️ 注意事项"></a>⚠️ 注意事项</h3><ol><li><strong>大气校正影响</strong>：大气校正对影像反射率的影响非常大，转换后仍需进一步校正</li><li><strong>传感器特性</strong>：需考虑不同传感器的特性和响应函数差异</li><li><strong>环境因素</strong>：实际应用中还需考虑水体类型、气象条件等环境因素的影响</li></ol><h2 id="📚-参考文献"><a href="#📚-参考文献" class="headerlink" title="📚 参考文献"></a>📚 参考文献</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span>孔祥生, 张安定, 钱永刚, 董宇阳. (2011). 地物光谱反射率测量与行星反射率计算联合教学设计与实践. <em>测绘科学</em>, 36(5), 234-236. DOI: 10.16251&#x2F;j.cnki.1009-2307.2011.05.087<a href="#fnref:1" rev="footnote" class="footnote-backref"> ↩</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>遥感数据处理</category>
      
    </categories>
    
    
    <tags>
      
      <tag>等效遥感反射率转换</tag>
      
      <tag>光谱响应函数</tag>
      
      <tag>高光谱反射率</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
